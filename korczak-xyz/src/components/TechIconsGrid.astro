---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface TechIcon {
  icon: ImageMetadata;
  label: string;
}

interface Props {
  icons: TechIcon[];
}

const { icons } = Astro.props;
---

<div class="tech-icons">
  {icons.map(({ icon, label }) => (
    <button type="button" class="tech-icon" tabindex="0">
      <div class="icon-image-container">
        <Image src={icon} alt={label} width={48} />
      </div>
      <span class="icon-label">{label}</span>
    </button>
  ))}
</div>

<style>
  .tech-icons {
    display: flex;
    justify-content: flex-start;
    gap: 8px;
    flex-wrap: wrap;
  }

  .tech-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 75px;
    padding: 4px;
    cursor: default;
    background: transparent;
    border: none;
    font-family: inherit;
  }

  .tech-icon:focus {
    outline: none;
  }

  /* Fixed-size container for icon images - Win95 style */
  .icon-image-container {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 2px;
    position: relative;
  }

  .tech-icon img {
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    border: none;
    box-shadow: none;
    filter: none;
    max-width: 48px;
    max-height: 48px;
    object-fit: contain;
  }

  .icon-label {
    font-family: 'VT323', monospace;
    font-size: 0.9rem;
    color: var(--retro-white);
    text-align: center;
    text-shadow: 1px 1px 0 var(--retro-navy);
    padding: 1px 3px;
    max-width: 100%;
    word-wrap: break-word;
    line-height: 1.1;
  }

  /* Win95 hover state - highlight label with dotted border */
  .tech-icon:hover .icon-label {
    background: var(--retro-navy);
    text-shadow: none;
    outline: 1px dotted var(--retro-white);
    outline-offset: 0px;
  }

  /* Win95 selected/focus state - persists after click */
  .tech-icon:focus .icon-label,
  .tech-icon.selected .icon-label {
    background: var(--retro-navy);
    text-shadow: none;
    outline: 1px dotted var(--retro-white);
    outline-offset: 0px;
  }

  /* Win95 active/mousedown state */
  .tech-icon:active .icon-label {
    background: var(--retro-navy);
    text-shadow: none;
    outline: 1px dotted var(--retro-white);
  }

  /* Win95 dithered overlay pattern for selected icons */
  .tech-icon:focus .icon-image-container::after,
  .tech-icon.selected .icon-image-container::after {
    content: '';
    position: absolute;
    inset: 0;
    /* Win95 checkerboard dither pattern */
    background-image: url("data:image/svg+xml,%3Csvg width='2' height='2' xmlns='http://www.w3.org/2000/svg'%3E%3Crect x='0' y='0' width='1' height='1' fill='%23000080' fill-opacity='0.5'/%3E%3Crect x='1' y='1' width='1' height='1' fill='%23000080' fill-opacity='0.5'/%3E%3C/svg%3E");
    background-size: 2px 2px;
    image-rendering: pixelated;
    pointer-events: none;
  }

  /* Also show dithered overlay on hover */
  .tech-icon:hover .icon-image-container::after {
    content: '';
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg width='2' height='2' xmlns='http://www.w3.org/2000/svg'%3E%3Crect x='0' y='0' width='1' height='1' fill='%23000080' fill-opacity='0.5'/%3E%3Crect x='1' y='1' width='1' height='1' fill='%23000080' fill-opacity='0.5'/%3E%3C/svg%3E");
    background-size: 2px 2px;
    image-rendering: pixelated;
    pointer-events: none;
  }
</style>
