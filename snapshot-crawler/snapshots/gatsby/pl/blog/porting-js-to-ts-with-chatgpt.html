<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="icon" href="/favicon-32x32.png" type="image/png" />
  </head>
  <body>
    <div>
      <div>
        <div>
          <div>
            <div>
              <div><img alt="" /></div>
              <img alt="logo" />
            </div>
            <a href="/">korczak.xyz</a>
          </div>
          <div></div>
          <label
            ><input type="checkbox" checked="" />
            <div></div>
            <span>Dark mode</span></label
          ><button aria-label="Menu">
            <svg viewBox="0 0 512 512">
              <path
                fill="currentColor"
                d="M61.1 224C45 224 32 211 32 194.9c0-1.9 .2-3.7 .6-5.6C37.9 168.3 78.8 32 256 32s218.1 136.3 223.4 157.3c.5 1.9 .6 3.7 .6 5.6c0 16.1-13 29.1-29.1 29.1L61.1 224zM144 128a16 16 0 1 0 -32 0 16 16 0 1 0 32 0zm240 16a16 16 0 1 0 0-32 16 16 0 1 0 0 32zM272 96a16 16 0 1 0 -32 0 16 16 0 1 0 32 0zM16 304c0-26.5 21.5-48 48-48l384 0c26.5 0 48 21.5 48 48s-21.5 48-48 48L64 352c-26.5 0-48-21.5-48-48zm16 96c0-8.8 7.2-16 16-16l416 0c8.8 0 16 7.2 16 16l0 16c0 35.3-28.7 64-64 64L96 480c-35.3 0-64-28.7-64-64l0-16z"
              ></path>
            </svg>
          </button>
        </div>
        <nav>
          <div>
            <div>
              <div><img alt="" /></div>
              <img alt="logo" />
            </div>
            <a href="/">korczak.xyz</a>
          </div>
          <div></div>
          <a href="/pl/">Główna</a><a href="/pl/about/">O mnie</a><a href="/pl/mentoring/">Mentoring</a
          ><a href="/pl/courses/">Kursy</a><a href="/pl/blog/">Blog</a><a href="/pl/songs/">Teksty</a
          ><label
            ><input type="checkbox" checked="" />
            <div></div>
            <span>Dark mode</span></label
          >
          <div>
            <a href="/blog/porting-js-to-ts-with-chatgpt/"><img alt="" /></a
            ><a href="/pl/blog/porting-js-to-ts-with-chatgpt/"><img alt="" /></a>
          </div>
        </nav>
      </div>
      <div>
        <div>
          <div>
            <header><h1>Portowanie JS do TS z użyciem ChatGPT</h1></header>
            <main>
              <section itemprop="articleBody">
                <iframe
                  width="560"
                  height="315"
                  src="https://www.youtube.com/embed/7ih7E_Viesg"
                  title="YouTube video player"
                  frameborder="0"
                  allow="
                    accelerometer;
                    autoplay;
                    clipboard-write;
                    encrypted-media;
                    gyroscope;
                    picture-in-picture;
                    web-share;
                  "
                  referrerpolicy="strict-origin-when-cross-origin"
                  allowfullscreen=""
                ></iframe>
                <h2>Wstęp</h2>
                <p>
                  Kolega mi opowiadał, że pracował raz przy projekcie, którego celem było portowanie kodu z Pythona 2 do
                  3. To był projekt dla całego teamu na kilka kwartałów. Ludzie się na tym wypalali. Tak się składa, że
                  to był projekt open-source, który dodatkowo nie był zbyt dobrze pokryty testami. Nic przyjemnego.
                </p>
                <h2>Strona osobista</h2>
                <p>
                  Ja zrobiłem swoją stronę osobistą początkowo w WordPress, później przepisałem ją w Gatsby w JS. No i
                  stawał się coraz popularniejszy ChatGPT, więc uznałem, że można spróbować przeportować to na TS. Dodam
                  tylko, że nie znałem za bardzo TS. Nie jest to rocket science, ale nie napisałem do tamtej pory
                  żadnego kodu w TS. Można powiedzieć, że ChatGPT nie tylko przeportował mi codebase, ale również
                  nauczył TS i zrobił coverage.
                </p>
                <h2>Pierwsze próby</h2>
                <p>
                  Pierwsze próby wyglądały dość obiecująco, ponieważ JS i TS są w gruncie rzeczy dość podobne.
                  Przeportowanie pojedynczego pliku zazwyczaj nie było problemem dla ChatGPT. Postanowiłem więc pójść
                  dalej i zautomatyzować portowanie.
                </p>
                <h2>Porter</h2>
                <p>
                  Porter - tak nazywa się moja próba napisania automatu do portowania całego repozytorium z języka
                  programowania X na język programowania Y. Kod źródłowy jest dostępny na GitHub, jednak nie jest to
                  działająca rzecz. Teoretycznie zadanie wydawało się proste.
                </p>
                <span
                  ><figure>
                    <span>
                      <a
                        href="/static/a9607d38d6441d5eba4516868c7ad536/c08c5/dont-crash-into-each-other.jpg"
                        target="_blank"
                        rel="noopener"
                      >
                        <span></span>
                        <img alt="dont crash into each other" />
                      </a>
                    </span>
                    <figcaption>dont crash into each other</figcaption>
                  </figure></span
                >
                <h3>Pierwsze podejście</h3>
                <span
                  ><div>
                    <pre><code><span>for</span> file <span>in</span> <span>files</span><span>:</span>
    ported <span>=</span> <span>prompt_gpt_to_port_file</span><span>(</span>file<span>)</span>
    file<span>.</span><span>write</span><span>(</span>ported<span>)</span></code></pre>
                  </div></span
                >
                <h3>Sprawdźmy czy kod działa</h3>
                <span
                  ><div>
                    <pre><code><span>for</span> file <span>in</span> <span>files</span><span>:</span>
    ported <span>=</span> <span>prompt_gpt_to_port_file</span><span>(</span>file<span>)</span>

    test_errors <span>=</span> <span>test</span><span>(</span>ported<span>)</span>
    <span>if</span> <span>test_errors</span><span>:</span>
        <span>prompt_gpt_to_fix_errors</span><span>(</span>ported<span>,</span> test_errors<span>)</span>

    file<span>.</span><span>write</span><span>(</span>ported<span>)</span></code></pre>
                  </div></span
                >
                <h3>Sprawdźmy czy kod się kompiluje</h3>
                <span
                  ><div>
                    <pre><code><span>for</span> file <span>in</span> <span>files</span><span>:</span>
    ported <span>=</span> <span>prompt_gpt_to_port_file</span><span>(</span>file<span>)</span>

    compilation_errors <span>=</span> <span>compile</span><span>(</span>ported<span>)</span>
    <span>if</span> <span>compilation_errors</span><span>:</span>
        <span>prompt_gpt_to_fix_errors</span><span>(</span>ported<span>,</span> compilation_errors<span>)</span>

    test_errors <span>=</span> <span>test</span><span>(</span>ported<span>)</span>
    <span>if</span> <span>test_errors</span><span>:</span>
        <span>prompt_gpt_to_fix_errors</span><span>(</span>ported<span>,</span> test_errors<span>)</span>

    file<span>.</span><span>write</span><span>(</span>ported<span>)</span></code></pre>
                  </div></span
                >
                <h3>Czasami jedna runda poprawek nie wystarcza</h3>
                <span
                  ><div>
                    <pre><code><span>for</span> file <span>in</span> <span>files</span><span>:</span>
    ported <span>=</span> <span>prompt_gpt_to_port_file</span><span>(</span>file<span>)</span>

    compilation_errors <span>=</span> <span>compile</span><span>(</span>ported<span>)</span>
    <span>while</span> <span>compilation_errors</span><span>:</span>
        <span>prompt_gpt_to_fix_errors</span><span>(</span>ported<span>,</span> compilation_errors<span>)</span>

    test_errors <span>=</span> <span>test</span><span>(</span>ported<span>)</span>
    <span>while</span> <span>test_errors</span><span>:</span>
        <span>prompt_gpt_to_fix_errors</span><span>(</span>ported<span>,</span> test_errors<span>)</span>

    file<span>.</span><span>write</span><span>(</span>ported<span>)</span></code></pre>
                  </div></span
                >
                <h2>Refleksja</h2>
                <p>
                  Wydaje się, że dodaliśmy sporo logiki specyficznej dla danego problemu - nie jest to ogólne
                  rozwiązanie portowania z języka X na Y. Jestem sobie w stanie wyobrazić, że w wielu przypadkach nie
                  jest to tak proste, że można portować po prostu pliki po kolei. Czasami trzeba stworzyć więcej plików,
                  wprowadzić zmiany w jakichś innych itp. Jednak wydaje się, że ChatGPT powinien to wiedzieć. W końcu
                  możemy zapytać go, w jaki sposób przeportować codebase z języka X na Y i bez problemu odpowie i ułoży
                  plan działania.
                </p>
                <h2>BabyAGI, AutoGPT</h2>
                <p>
                  Te projekty są bardzo ambitne i chodzi o to, żeby GPT sam się promptował w pętli i w ten sposób
                  rozwiązywał złożone problemy uwzględniając planowanie i wykonywanie działań. Kiedy zacząłem z nich
                  korzystać, okazało się, że nie jest to takie proste i diabeł tkwi w szczegółach:
                </p>
                <ol>
                  <li>
                    Jest drogo - GPT3.5 co prawda nie jest super drogie per request, ale kontekst jest zbyt krótki i nie
                    ogarnia tak dobrze, jak GPT4. A odpalenie jednego eksperymentu z GPT4 kosztowało kilka dolarów, więc
                    jak sobie to szybko policzyłem, to na takie eksperymenty mnie nie stać, szczególnie biorąc pod
                    uwagę, że nie wiadomo czy na koniec to będzie działać. szczególnie biorąc pod uwagę że nie wiadomo
                    czy na koniec to będzie działać
                  </li>
                  <li>
                    Długo to trwa - GPT3.5 jest szybkie, ale nie ogarnia, a GPT4 jest sporo wolniejsze, więc każdy test
                    sporo trwa.
                  </li>
                  <li>Dobre promptowanie jest trudne.</li>
                  <li>Nie miałem dostępu do API GPT-4, więc korzystałem z API kolegi, ale to też ma swoje wady.</li>
                </ol>
                <h2>Langchain</h2>
                <p>W tym projekcie chodzi o to, żeby zdefiniować narzędzia dla GPT, takie jak np:</p>
                <ul>
                  <li>
                    walidacja kodu <span><code>tsc --noEmit</code></span>
                  </li>
                  <li>
                    testowanie kodu <span><code>npm run test</code></span>
                  </li>
                  <li>
                    klonowanie repozytorium <span><code>git clone ...</code></span>
                  </li>
                </ul>
                <p>W ten sposób ułatwiamy zadanie, żeby GPT nie musiał wszystkiego kminić od zera.</p>
                <p>
                  Był mały sukces. Wydaje mi się, że z użyciem któregoś z tych narzędzi udało mi się sprawić, że po
                  wpisaniu komendy w stylu:
                </p>
                <span
                  ><div>
                    <pre><code>python porter.py &lt;link do repo&gt;</code></pre>
                  </div></span
                >
                <p>Skrypt przeportował jeden plik, zrobił commit i otworzył pull-requesta.</p>
                <h2>Ostateczne rozwiazanie</h2>
                <p>
                  Po kilku nieprzespanych nocach, wzlotach i upadkach, uznałem, że problem jest za duży na moją głowę,
                  albo że narzędzia nie są jeszcze wystarczająco mocne, żeby dało się napisać portera. Postanowiłem, że
                  większą wartość będzie miało dla mnie wykonanie zadania niż tworzenie narzędzia, które nie wiadomo czy
                  da się stworzyć. Dlatego postawiłem na stary sprawdzony wzorzec projektowy kopiego-pasta. Czyli plik
                  po pliku kopiowałem do ChatuGPT, następnie wklejałem do IDE, odpalałem testy, kompilator i feedowałem
                  spowrotem do ChatuGPT jeśli były błędy.
                </p>
                <h2>Nowe funkcjonalności</h2>
                <p>
                  Miesiąc temu do ChatuGPT został dodany Code Interpreter. Fajną rzeczą jest to, że można mu wrzucić zip
                  z kodem i on umie sobie po nim chodzić i czytać pliki itp. Ułatwiło to sprawę.
                </p>
                <h2>Podsumowanie</h2>
                <p>
                  Bez ChatuGPT nadal nie umiałbym TS, a także bym miał o wiele słabszy codebase. Pełna automatyzacja
                  takich złożonych zadań wydaje się, że jest jeszcze poza zasięgiem, ale w tej branży sprawy idą tak
                  szybko, że może już ktoś to zrobił :p
                </p>
                <h2>Uznanie autorstwa</h2>
                <p>
                  Photo by
                  <a
                    href="https://unsplash.com/@esmonde?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"
                    >Esmonde Yong</a
                  >
                  on
                  <a
                    href="https://unsplash.com/photos/wFpJV5EWrSM?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"
                    >Unsplash</a
                  >
                </p>
              </section>
            </main>
          </div>
        </div>
        <footer><a href="/">korczak.xyz</a></footer>
      </div>
    </div>
  </body>
</html>
