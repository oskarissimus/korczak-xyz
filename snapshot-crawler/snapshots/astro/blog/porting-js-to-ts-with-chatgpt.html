<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Personal website of Oskar Korczak" />
    <meta name="image" content="https://korczak.xyz/logo.png" />
    <link rel="icon" href="/favicon-32x32.png" type="image/png" />
    <title>Porting JS to TS using ChatGPT | korczak.xyz</title>
  </head>
  <body>
    <div>
      <div>
        <div>
          <div><img alt="logo" /> <a href="/">korczak.xyz</a></div>
          <div></div>
          <astro-island
            uid="Z1QhqvY"
            prefix="r2"
            component-url="/_astro/DarkModeSwitch.BQNEYJL_.js"
            component-export="default"
            renderer-url="/_astro/client.9unXo8s5.js"
            props='{"className":[0,"block md:hidden"]}'
            client="load"
            opts='{"name":"DarkModeSwitch","value":true}'
            await-children=""
            ><label
              ><input type="checkbox" />
              <div></div>
              <span>Dark mode</span></label
            ></astro-island
          >
          <button aria-label="Menu" id="menu-button">
            <svg fill="currentColor" viewBox="0 0 448 512">
              <path
                d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"
              ></path>
            </svg>
          </button>
        </div>
        <nav id="main-nav">
          <div><img alt="logo" /> <a href="/">korczak.xyz</a></div>
          <div></div>
          <a href="/">Home</a><a href="/about/">About</a><a href="/mentoring/">Mentoring</a
          ><a href="/courses/">Courses</a><a href="/blog/">Blog</a><a href="/songs/">Songs</a>
          <astro-island
            uid="18Ow2c"
            prefix="r3"
            component-url="/_astro/DarkModeSwitch.BQNEYJL_.js"
            component-export="default"
            renderer-url="/_astro/client.9unXo8s5.js"
            props='{"className":[0,"hidden md:block"]}'
            client="load"
            opts='{"name":"DarkModeSwitch","value":true}'
            await-children=""
            ><label
              ><input type="checkbox" checked="" />
              <div></div>
              <span>Dark mode</span></label
            ></astro-island
          >
          <div>
            <a href="/blog/porting-js-to-ts-with-chatgpt/"> <span role="img" aria-label="en">ðŸ‡¬ðŸ‡§</span> </a>
            <a href="/pl/blog/porting-js-to-ts-with-chatgpt/"> <span role="img" aria-label="pl">ðŸ‡µðŸ‡±</span> </a>
          </div>
        </nav>
      </div>
      <div>
        <div>
          <div>
            <header><h1>Porting JS to TS using ChatGPT</h1></header>
            <main>
              <section itemprop="articleBody">
                <iframe
                  width="560"
                  height="315"
                  src="https://www.youtube.com/embed/7ih7E_Viesg"
                  title="YouTube video player"
                  frameborder="0"
                  allow="
                    accelerometer;
                    autoplay;
                    clipboard-write;
                    encrypted-media;
                    gyroscope;
                    picture-in-picture;
                    web-share;
                  "
                  referrerpolicy="strict-origin-when-cross-origin"
                  allowfullscreen=""
                ></iframe>
                <h2 id="introduction">Introduction</h2>
                <p>
                  A colleague told me that he once worked on a project aimed at porting code from Python 2 to 3. It was
                  a project for the whole team spanning several quarters. People burned out on it. Coincidentally, it
                  was an open-source project that was also not very well covered by tests. Not pleasant.
                </p>
                <h2 id="personal-website">Personal website</h2>
                <p>
                  I initially created my personal website in WordPress, then rewrote it in Gatsby in JS. ChatGPT was
                  becoming more popular, so I decided to try porting it to TS. Iâ€™ll add that I didnâ€™t really know TS
                  very well. Itâ€™s not rocket science, but until then I hadnâ€™t written any code in TS. One could say that
                  ChatGPT not only ported my codebase but also taught me TS and did coverage.
                </p>
                <h2 id="first-attempts">First attempts</h2>
                <p>
                  The first attempts looked quite promising because JS and TS are fundamentally quite similar. Porting a
                  single file was usually not a problem for ChatGPT. So I decided to go further and automate the
                  porting.
                </p>
                <h2 id="porter">Porter</h2>
                <p>
                  Porter - this is my attempt at creating an automaton for porting an entire repository from programming
                  language X to programming language Y. The source code is available on GitHub, but itâ€™s not a working
                  thing. Theoretically, the task seemed simple.
                </p>
                <p><img alt="dont crash into each other" /></p>
                <h3 id="first-approach">First approach</h3>
                <pre
                  tabindex="0"
                ><code><span><span>for file </span><span>in</span><span> files</span><span>:</span></span>
<span><span>    ported </span><span>=</span><span> prompt_gpt_to_port_file</span><span>(file)</span></span>
<span><span>    file</span><span>.write</span><span>(ported)</span></span></code></pre>
                <h3 id="lets-check-if-the-code-works">Letâ€™s check if the code works</h3>
                <pre
                  tabindex="0"
                ><code><span><span>for file </span><span>in</span><span> files</span><span>:</span></span>
<span><span>    ported </span><span>=</span><span> prompt_gpt_to_port_file</span><span>(file)</span></span>
<span></span>
<span><span>    test_errors </span><span>=</span><span> test</span><span>(ported)</span></span>
<span><span>    if</span><span> test_errors</span><span>:</span></span>
<span><span>        prompt_gpt_to_fix_errors</span><span>(ported</span><span>,</span><span> test_errors)</span></span>
<span></span>
<span><span>    file</span><span>.write</span><span>(ported)</span></span></code></pre>
                <h3 id="lets-check-if-the-code-compiles">Letâ€™s check if the code compiles</h3>
                <pre
                  tabindex="0"
                ><code><span><span>for file </span><span>in</span><span> files</span><span>:</span></span>
<span><span>    ported </span><span>=</span><span> prompt_gpt_to_port_file</span><span>(file)</span></span>
<span></span>
<span><span>    compilation_errors </span><span>=</span><span> compile</span><span>(ported)</span></span>
<span><span>    if</span><span> compilation_errors</span><span>:</span></span>
<span><span>        prompt_gpt_to_fix_errors</span><span>(ported</span><span>,</span><span> compilation_errors)</span></span>
<span></span>
<span><span>    test_errors </span><span>=</span><span> test</span><span>(ported)</span></span>
<span><span>    if</span><span> test_errors</span><span>:</span></span>
<span><span>        prompt_gpt_to_fix_errors</span><span>(ported</span><span>,</span><span> test_errors)</span></span>
<span></span>
<span><span>    file</span><span>.write</span><span>(ported)</span></span></code></pre>
                <h3 id="sometimes-one-round-of-fixes-is-not-enough">Sometimes one round of fixes is not enough</h3>
                <pre
                  tabindex="0"
                ><code><span><span>for file </span><span>in</span><span> files</span><span>:</span></span>
<span><span>    ported </span><span>=</span><span> prompt_gpt_to_port_file</span><span>(file)</span></span>
<span></span>
<span><span>    compilation_errors </span><span>=</span><span> compile</span><span>(ported)</span></span>
<span><span>    while</span><span> compilation_errors</span><span>:</span></span>
<span><span>        prompt_gpt_to_fix_errors</span><span>(ported</span><span>,</span><span> compilation_errors)</span></span>
<span></span>
<span><span>    test_errors </span><span>=</span><span> test</span><span>(ported)</span></span>
<span><span>    while</span><span> test_errors</span><span>:</span></span>
<span><span>        prompt_gpt_to_fix_errors</span><span>(ported</span><span>,</span><span> test_errors)</span></span>
<span></span>
<span><span>    file</span><span>.write</span><span>(ported)</span></span></code></pre>
                <h2 id="reflection">Reflection</h2>
                <p>
                  It seems that we added a lot of logic specific to a particular problem - itâ€™s not a general solution
                  for porting from language X to Y. I can imagine that in many cases itâ€™s not as simple as just porting
                  files one by one. Sometimes you have to create more files, make changes in some others, etc. However,
                  it seems that ChatGPT should know that. After all, we can ask it how to port a codebase from language
                  X to Y, and it will readily respond and outline a plan of action.
                </p>
                <h2 id="babyagi-autogpt">BabyAGI, AutoGPT</h2>
                <p>
                  These projects are very ambitious, aiming for GPT to prompt itself in a loop, thus solving complex
                  problems by planning and executing actions. When I started using them, it turned out that it wasnâ€™t
                  that simple, and the devil is in the details:
                </p>
                <ol>
                  <li>
                    Itâ€™s expensive - GPT3.5 isnâ€™t super expensive per request, but the context is too short and doesnâ€™t
                    perform as well as GPT4. Running one experiment with GPT4 cost a few dollars, so when I quickly
                    calculated, I couldnâ€™t afford such experiments, especially considering itâ€™s uncertain if it would
                    work in the end.
                  </li>
                  <li>
                    It takes a long time - GPT3.5 is fast but doesnâ€™t perform well, and GPT4 is much slower, so every
                    test takes a long time.
                  </li>
                  <li>Good prompting is difficult.</li>
                  <li>I didnâ€™t have access to the GPT-4 API, so I used a friendâ€™s API, but that has its drawbacks.</li>
                </ol>
                <h2 id="langchain">Langchain</h2>
                <p>The idea of this project is to define tools for GPT, such as:</p>
                <ul>
                  <li>Code validation tsc â€”noEmit</li>
                  <li>Code testing npm run test</li>
                  <li>Repository cloning git clone â€¦</li>
                </ul>
                <p>This way, we make it easier for GPT not to have to figure everything out from scratch.</p>
                <p>
                  There was a minor success. I think that using one of these tools, I managed to make it so that after
                  entering a command like:
                </p>
                <pre tabindex="0"><code><span><span>python porter.py &lt;link to the repo&gt;</span></span></code></pre>
                <p>The script ported one file, made a commit, and opened a pull request.</p>
                <h2 id="final-solution">Final solution</h2>
                <p>
                  After several sleepless nights, ups and downs, I concluded that the problem was too big for me, or
                  that the tools werenâ€™t powerful enough yet to write a porter. I decided that doing the task would be
                  more valuable to me than creating a tool that was uncertain if it could be created. Therefore, I
                  relied on the old tried-and-true design pattern of copy-paste. So, I copied each file to ChatGPT,
                  pasted it into the IDE, ran tests, the compiler, and fed it back to ChatGPT if there were errors.
                </p>
                <h2 id="new-features">New features</h2>
                <p>
                  A month ago, a Code Interpreter was added to ChatGPT. A cool thing is that you can throw a zip with
                  code at it, and it can navigate and read files, etc. This made things easier.
                </p>
                <h2 id="conclusion">Conclusion</h2>
                <p>
                  Without ChatGPT, I still wouldnâ€™t know TS, and my codebase would be much weaker. Full automation of
                  such complex tasks seems still out of reach, but things move so fast in this industry that maybe
                  someone has already done it :p
                </p>
                <h2 id="image-credits">Image credits</h2>
                <p>
                  Photo by
                  <a
                    href="https://unsplash.com/@esmonde?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"
                    >Esmonde Yong</a
                  >
                  on
                  <a
                    href="https://unsplash.com/photos/wFpJV5EWrSM?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"
                    >Unsplash</a
                  >
                </p>
              </section>
            </main>
          </div>
        </div>
        <footer><a href="/">korczak.xyz</a></footer>
      </div>
    </div>
  </body>
</html>
